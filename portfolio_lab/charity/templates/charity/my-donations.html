{% extends "base/base.html" %}
{% load static %}

{% block content %}
<header>
    {% include 'base/header.html' %}
</header>
<section class="user-donations">
    <h2>Moje zbiórki</h2>
    <div>
        <table id="donation-table">
            <tr>
                <th>Data utworzenia</th>
                <th>Ilość worków</th>
                <th>Instytucja</th>
                <th>Co w workach?</th>
                <th>Termin odbioru</th>
                <th colspan="2">Status</th>
                <th>Data potwierdzenia</th>
            </tr>
            {% for donation in user_donations %}
            {% if donation.user_id == user.id %}
            <tr>
                <td>{{ donation.created|date:'Y-m-d H:i'}}</td>
                <td>{{ donation.quantity }} szt.</td>
                <td>{{ donation.institution.name_type_of }} "{{ donation.institution.name }}"</td>
                <td>
                    {% for category in donation.categories.all %}
                    {{ category.name }}
                    {% endfor %}
                </td>
                <td>{{ donation.pick_up_date|date:'Y-m-d' }} &nbsp;&nbsp;godz. {{ donation.pick_up_time|time:'H:i'}}
                </td>
                <td class="pick-up-donation">
                    {% if donation.is_taken == True %}
                    Odebrane, dziękujemy!
                    {% else %}
                    Czeka na odbiór przez kuriera
                    {% endif %}
                </td>
                <td class="pick-up-donation">
                    {% if donation.is_taken == True %}
                    <form method="POST" action="">
                        {% csrf_token %}
                        <button type="submit" name="donation_id_back" value="{{ donation.id }}"
                                class="btn btn--without-border">Cofnij potwierdzenie
                        </button>
                    </form>
                    {% else %}
                    <form method="POST" action="">
                        {% csrf_token %}
                        <button type="submit" name="donation_id" value="{{ donation.id }}"
                                class="btn btn--without-border">Potwierdź odbiór
                        </button>
                    </form>
                    {% endif %}
                </td>
                <td>
                    {% if donation.is_taken == True %}
                    {{ donation.picked_up|date:'Y-m-d H:i'}}
                    {% endif %}
                </td>
            </tr>
            {% endif %}
            {% endfor %}
        </table>
    </div>
    <div class="user-page">
        <a href="{% url 'landing-page' %}" class="btn">Powrót</a>
    </div>
</section>

{% include 'base/footer.html' %}

{% endblock content %}
